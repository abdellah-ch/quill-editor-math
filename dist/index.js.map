{"version":3,"file":"index.js","sources":["../src/components/QuillEditor.tsx","../src/components/Editor.tsx","../src/index.tsx"],"sourcesContent":["import $ from 'jquery'\nimport katex from 'katex'\nimport React, { useEffect, useRef, useState } from 'react'\nimport ReactQuill, { Quill } from 'react-quill'\nimport BlotFormatter from 'quill-blot-formatter'\nimport { IEditor } from '../interface'\n\nlet mathquill4quill: (arg0: { Quill: typeof Quill; katex: any }) => any\nif (typeof window !== 'undefined') {\n  // @ts-ignore\n  window.katex = katex\n  // @ts-ignore\n  window.jQuery = window.$ = $\n  mathquill4quill = require('mathquill4quill')\n  require('@edtr-io/mathquill/build/mathquill.js')\n}\n\nQuill.register('modules/blotFormatter', BlotFormatter)\n\nconst customOperator = [\n  ['\\\\pm', '\\\\pm'],\n  ['\\\\sqrt{x}', '\\\\sqrt'],\n  ['\\\\sqrt[3]{x}', '\\\\sqrt[3]{}'],\n  ['\\\\sqrt[n]{x}', '\\\\nthroot'],\n  ['\\\\frac{x}{y}', '\\\\frac'],\n  ['\\\\sum^{s}_{x}{d}', '\\\\sum'],\n  ['\\\\prod^{s}_{x}{d}', '\\\\prod'],\n  ['\\\\coprod^{s}_{x}{d}', '\\\\coprod'],\n  ['\\\\int^{s}_{x}{d}', '\\\\int'],\n  ['\\\\binom{n}{k}', '\\\\binom']\n]\n\nconst QuillEditor = (props: IEditor) => {\n  const defaultToolbar = [\n    ['bold', 'italic', 'underline', 'strike'], // toggled buttons\n    ['blockquote', 'code-block'],\n\n    [{ list: 'ordered' }, { list: 'bullet' }],\n    [{ script: 'sub' }, { script: 'super' }], // superscript/subscript\n    [{ header: [1, 2, 3, false] }],\n    [{ direction: 'rtl' }],\n    ['link', 'image', 'formula'],\n\n    [{ color: [] }, { background: [] }], // dropdown with defaults from theme\n    [{ align: [] }],\n\n    ['clean'] // remove formatting button\n  ]\n\n  const reactQuill = useRef(null)\n\n  const [editorHtml, setEditorHtml] = useState('')\n  let didAttachQuillRefs = false\n  const attachQuillRefs = () => {\n    if (!didAttachQuillRefs) {\n      const enableMathQuillFormulaAuthoring = mathquill4quill({ Quill, katex })\n      // @ts-ignore\n      enableMathQuillFormulaAuthoring(reactQuill?.current.editor, {\n        operators: props.customOperator || customOperator,\n        displayHistory: true\n      })\n      didAttachQuillRefs = true\n    }\n  }\n\n  useEffect(() => {\n    attachQuillRefs()\n  }, [])\n\n  useEffect(() => {\n    if (props.initialValue) {\n      setEditorHtml(props.initialValue)\n    }\n  }, [props.initialValue])\n\n  useEffect(() => {\n    if (props.resetField) {\n      setEditorHtml('')\n    }\n  }, [props.resetField])\n\n  const handleChange = (value: string) => {\n    setEditorHtml(value)\n    props.onChange && props.onChange(value)\n  }\n\n  return (\n    <ReactQuill\n      ref={reactQuill}\n      modules={{\n        formula: true,\n        toolbar: props.toolbar || defaultToolbar,\n        clipboard: {\n          // toggle to add extra line breaks when pasting HTML:\n          matchVisual: false\n        },\n        blotFormatter: {}\n      }}\n      value={editorHtml}\n      onChange={handleChange}\n      // @ts-ignore\n      onBlur={props.onBlur}\n      theme={props.theme || 'snow'}\n      placeholder={props.placeholder || 'Write something..'}\n      bounds='.quill'\n      readOnly={props.readOnly}\n    />\n  )\n}\n\nexport default QuillEditor\n","/* eslint-disable no-unused-vars */\nimport React from 'react'\nimport QuillEditor from './QuillEditor'\nimport { IEditor } from '../interface'\n\nconst Editor: React.FC<IEditor> = (props) => {\n  return <QuillEditor {...props} />\n}\n\nexport default Editor\n","/* eslint-disable no-unused-vars */\nimport * as React from 'react'\nimport Editor from './components/Editor'\nimport './styles.module.css'\nimport { IEditor } from './interface'\n\nconst QuillEditor: React.FC<IEditor> = (props) => {\n  return <Editor {...props} />\n}\n\nexport default QuillEditor\n"],"names":["mathquill4quill","window","katex","jQuery","$","require","Quill","register","BlotFormatter","customOperator","QuillEditor","props","defaultToolbar","list","script","header","direction","color","background","align","reactQuill","useRef","useState","editorHtml","setEditorHtml","didAttachQuillRefs","attachQuillRefs","enableMathQuillFormulaAuthoring","current","editor","operators","displayHistory","useEffect","initialValue","resetField","handleChange","value","onChange","React","ReactQuill","ref","modules","formula","toolbar","clipboard","matchVisual","blotFormatter","onBlur","theme","placeholder","bounds","readOnly","Editor"],"mappings":"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"}