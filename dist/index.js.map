{"version":3,"file":"index.js","sources":["../src/components/QuillEditor.tsx","../src/components/Editor.tsx","../src/index.tsx"],"sourcesContent":["import $ from 'jquery'\nimport katex from 'katex'\nimport React from 'react'\nimport ReactQuill, { Quill } from 'react-quill'\n// @ts-ignore\nimport ImageResize from 'quill-image-resize-module-react'\n\nlet mathquill4quill: (arg0: { Quill: typeof Quill; katex: any }) => any\nif (typeof window !== 'undefined') {\n  // @ts-ignore\n  window.katex = katex\n  // @ts-ignore\n  window.jQuery = window.$ = $\n  mathquill4quill = require('mathquill4quill')\n  require('@edtr-io/mathquill/build/mathquill.js')\n}\n\nQuill.register('modules/imageResize', ImageResize)\n\nconst customOperator = [\n  ['\\\\pm', '\\\\pm'],\n  ['\\\\sqrt{x}', '\\\\sqrt'],\n  ['\\\\sqrt[3]{x}', '\\\\sqrt[3]{}'],\n  ['\\\\sqrt[n]{x}', '\\\\nthroot'],\n  ['\\\\frac{x}{y}', '\\\\frac'],\n  ['\\\\sum^{s}_{x}{d}', '\\\\sum'],\n  ['\\\\prod^{s}_{x}{d}', '\\\\prod'],\n  ['\\\\coprod^{s}_{x}{d}', '\\\\coprod'],\n  ['\\\\int^{s}_{x}{d}', '\\\\int'],\n  ['\\\\binom{n}{k}', '\\\\binom']\n]\nclass QuillEditor extends React.Component {\n  constructor(props: {} | Readonly<{}>) {\n    super(props)\n    // @ts-ignore\n    this.reactQuill = React.createRef()\n    this.state = {\n      // @ts-ignore\n      editorHtml: this.props.initialValue,\n      theme: 'snow',\n      placeholder: 'Write something...'\n    }\n    this.handleChange = this.handleChange.bind(this)\n    this.attachQuillRefs = this.attachQuillRefs.bind(this)\n  }\n\n  handleChange(html: string) {\n    this.setState({ editorHtml: html })\n    // @ts-ignore\n    this.props.onChange(html)\n  }\n\n  componentDidMount() {\n    // @ts-ignore\n    if (!this.didAttachQuillRefs) {\n      this.attachQuillRefs()\n      // @ts-ignore\n      this.didAttachQuillRefs = true\n    }\n  }\n\n  componentDidUpdate(prevProps: { initialValue: string }) {\n    // do something\n    if (prevProps.initialValue === '') {\n      // eslint-disable-next-line react/no-did-update-set-state\n      this.setState({\n        // @ts-ignore\n        editorHtml: this.props.initialValue\n      })\n    }\n  }\n\n  attachQuillRefs() {\n    const enableMathQuillFormulaAuthoring = mathquill4quill({ Quill, katex })\n    // @ts-ignore\n    enableMathQuillFormulaAuthoring(this.reactQuill.current.editor, {\n      // @ts-ignore\n      operators: this.props.customOperator || customOperator,\n      displayHistory: true\n    })\n  }\n\n  render() {\n    const defaultToolbar = [\n      ['bold', 'italic', 'underline', 'strike'], // toggled buttons\n      ['blockquote', 'code-block'],\n\n      [{ list: 'ordered' }, { list: 'bullet' }],\n      [{ script: 'sub' }, { script: 'super' }], // superscript/subscript\n      [{ header: [1, 2, 3, false] }],\n\n      ['link', 'image', 'formula'],\n\n      [{ color: [] }, { background: [] }], // dropdown with defaults from theme\n      [{ align: [] }],\n\n      ['clean'] // remove formatting button\n    ]\n\n    return (\n      // @ts-ignore\n      <ReactQuill\n        // @ts-ignore\n        ref={this.reactQuill}\n        modules={{\n          formula: true,\n          // @ts-ignore\n          toolbar: this.props.toolbar || defaultToolbar,\n          clipboard: {\n            // toggle to add extra line breaks when pasting HTML:\n            matchVisual: false\n          },\n          imageResize: {\n            parchment: Quill.import('parchment'),\n            modules: ['Resize', 'DisplaySize']\n          }\n        }}\n        // @ts-ignore\n        value={this.state.editorHtml}\n        // @ts-ignore\n        style={this.state.style}\n        // @ts-ignore\n        onChange={this.handleChange}\n        // @ts-ignore\n        onBlur={this.props.onBlur}\n        // @ts-ignore\n        theme={this.props.theme || 'snow'}\n        // @ts-ignore\n        placeholder={this.props.placeholder || 'Write something..'}\n        bounds='.quill'\n      />\n    )\n  }\n}\n\nexport default QuillEditor\n","/* eslint-disable no-unused-vars */\nimport React from 'react'\nimport QuillEditor from './QuillEditor'\nimport { DeltaStatic, RangeStatic, BoundsStatic, Sources } from 'quill'\n\ninterface UnprivilegedEditor {\n  getLength(): number\n  getText(index?: number, length?: number): string\n  getHTML(): string\n  getBounds(index: number, length?: number): BoundsStatic\n  getSelection(focus?: boolean): RangeStatic\n  getContents(index?: number, length?: number): DeltaStatic\n}\nexport interface IEditor {\n  initialValue: string\n  onChange?(value: string): void\n  onBlur?(\n    previousSelection: Range,\n    source: Sources,\n    editor: UnprivilegedEditor\n  ): void\n  placeholder?: string\n  style?: React.CSSProperties\n  theme?: string\n  customOperator?: []\n  toolbar?: []\n}\n\nconst Editor: React.FC<IEditor> = (props) => {\n  return <QuillEditor {...props} />\n}\n\nexport default Editor\n","/* eslint-disable no-unused-vars */\nimport * as React from 'react'\nimport Editor from './components/Editor'\nimport type { IEditor } from './components/Editor'\nimport './styles.module.css'\n\nconst QuillEditor: React.FC<IEditor> = (props) => {\n  return <Editor {...props} />\n}\n\nexport default QuillEditor\n"],"names":["mathquill4quill","window","katex","jQuery","$","require","Quill","register","ImageResize","customOperator","QuillEditor","props","reactQuill","React","createRef","state","editorHtml","initialValue","theme","placeholder","handleChange","bind","attachQuillRefs","html","setState","onChange","componentDidMount","didAttachQuillRefs","componentDidUpdate","prevProps","enableMathQuillFormulaAuthoring","current","editor","operators","displayHistory","render","defaultToolbar","list","script","header","color","background","align","ReactQuill","ref","modules","formula","toolbar","clipboard","matchVisual","imageResize","parchment","value","style","onBlur","bounds","Component","Editor"],"mappings":"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"}